---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection, getEntryBySlug } from "astro:content";

export async function getStaticPaths() {
  const events = await getCollection("events");
  return events.map(event => ({
    params: { slug: event.slug },
    props: { event },
  }));
}

const { event } = Astro.props;
const d = event.data;

const dateStr = d.date.toLocaleDateString("de-DE", {
  weekday: "long",
  day: "2-digit",
  month: "long",
  year: "numeric",
});

const isEventPast = d.date < new Date();

const { Content } = await event.render();
---

<BaseLayout title={`${d.title} â€“ Silver HH`}>
  <article class="card">
    <span class="badge">{d.format}</span>
    <h1>{d.title}</h1>

    <p>
      <strong>{dateStr}</strong><br />
      {d.startTime}<br />
      {d.venue}<br />
      {d.address}
    </p>

    <div style="display:flex; gap:12px; margin:16px 0;">
      {d.registerUrl && (
        <a class="btn primary" href={d.registerUrl}>Register</a>
      )}
      {d.resultsUrl && isEventPast && (
        <a class="btn" href={d.resultsUrl}>Results</a>
      )}
    </div>

    <hr style="border-color:var(--border); margin:20px 0;" />

    <div class="prose">
      <Content />
    </div>
  </article>
</BaseLayout>
